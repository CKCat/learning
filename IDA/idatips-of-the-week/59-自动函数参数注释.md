你可能注意到，IDA 对标准 API 或库函数非常了解，并会为传递给它们的参数自动添加函数注释。

示例： 在反汇编中，Win32 API `CreateFileW` 和 `ReadFile` 的调用处会自动显示参数注释。

![](assets/2021/10/pit_args1.png)

这种功能在函数以标准方式导入并且在加载时已知的情况下效果很好。

有时，实际调用的函数只有在分析过程中才能确定，例如：

- 通过 `GetProcAddress` 动态导入
- 使用名称哈希解析

在这种情况下，反汇编中可能只会看到调用了一个占位名称（dummy name），而没有任何参数注释。

![](assets/2021/10/pit_unmarked.png)

当然，你可以手动添加注释，例如标明 `dword_4031A5` 是 `CreateFileA`，并逐个参数加注释，但这会很繁琐。

实际上，只需将该指针变量重命名为对应的 API 名称，IDA 就会自动识别原型并为参数添加注释。

![](assets/2021/10/pit_marked.png)

**注意事项**

- 函数原型必须存在于已加载的类型库（type library）中
- 注释只会添加到函数内部的代码中，因此如果调用位于未定义为函数的区域（例如解密或解压后的代码），需要先创建函数
- 如果该函数在多个地方被调用，IDA 可能需要几秒钟来分析并为所有调用点添加注释

原文地址：https://hex-rays.com/blog/igors-tip-of-the-week-59-automatic-function-arguments-comments
