之前我们介绍过，从选区创建结构（`Create struct from selection`） 操作可以用来快速从已有数据项中创建结构。

![](assets/2020/08/sel_struct1.png)

不过，这个功能并不仅限于反汇编视图。假设你创建了一个结构来表示二进制程序使用的某个上下文：

```
00000000 Context         struc ; (sizeof=0x1C)
00000000 version         dd ?
00000004 pid             dd ?
00000008 tid             dd ?
0000000C listhead        dd ?                    ; offset
00000010 listtail        dd ?                    ; offset
00000014 count           dd ?
00000018 filename        dd ?
0000001C Context         ends
```

随着分析的深入，你发现其中的 `list` 结构 是通用的，并且在其他地方也独立使用。

在这个简单场景下，你当然可以手动新建一个 `List` 结构，并替换 `Context` 中的相关字段。 但如果子结构很大，包含上百个字段呢？

这时，使用 “从选区创建结构” 就能轻松完成：

1. 选中你想要提取的字段子集；

2. 执行该操作；

   ![](assets/2023/10/substruct1.png)

3. 根据需要重命名新结构和字段。

   ![](assets/2023/10/substruct2.png)

### 从栈帧中提取结构

另一个可以使用该操作的地方是 栈帧视图， 因为在内部，栈帧本质上也是一种结构。

![](assets/2023/10/substruct3.png)

相关内容：

[Igor’s tip of the week #11: Quickly creating structures](https://hex-rays.com/blog/igor-tip-of-the-week-11-quickly-creating-structures/)

[Igor’s tip of the week #03: Selection in IDA](https://hex-rays.com/blog/igor-tip-of-the-week-03-selection-in-ida/)

原文地址：https://hex-rays.com/blog/igors-tip-of-the-week-161-extracting-substructures
