IDA 主要使用标准 C（以及基础的 C++）语法，但它也支持一些扩展，特别是用于表示标准 C 代码中不需要、但在实际二进制分析中很有用的底层细节。

我们之前已经介绍过 自定义类型 和 调用约定，但还有更多扩展你可能会用到或遇到。

### 函数属性（Function attributes）
以下属性可用于函数原型：

- `__pure`：纯函数（对于相同输入总是返回相同结果，并且不会以可见方式影响内存）
- `__noreturn`：函数不会返回到调用者
- `__usercall` 或 `__userpurge`：用户自定义调用约定（见前一篇文章）
- `__spoils`：显式指定会被破坏（clobber）的寄存器（见前一篇文章）
- `__attribute__((format(printf, n1, n2)))`：可变参数函数，参数 `n1` 位置是 printf 风格的格式化字符串，参数 `n2` 位置是可变参数列表

### 参数属性（Argument attributes）
这些属性通常出现在 IDA 将用户提供的原型“降级”（lower）为实际底层参数传递细节时：

- `__hidden`：该参数在源代码中不存在（例如 C++ 类方法中的隐式 `this` 指针）
- `__return_ptr`：用于返回值的隐藏参数（隐含 `__hidden`）
- `__struct_ptr`：参数原本是结构体值
- `__array_ptr`：参数原本是数组
- `__unused`：未使用的函数参数

示例： 如果 `s1` 是一个 16 字节的结构体，以下原型：

```c
struct s1 func();
```

会被 IDA 降级为：

```
struct s1 *__cdecl func(struct s1 *__return_ptr __struct_ptr retstr);
```

### 其他属性（Other attributes）
- `__cppobj`：用于表示 C++ 对象的结构体；使用该属性时，一些布局细节会发生变化（例如空结构体的处理，或在继承中重用结构体末尾的填充字节）
- `__ptr32`、`__ptr64`：显式指定指针大小
- `__shifted`：指针指向对象内部或之前的位置，而不是对象起始位置

参考：

[Set function/item type](https://hex-rays.com/products/ida/support/idadoc/1361.shtml) in IDA Help.

原文地址：https://hex-rays.com/blog/igors-tip-of-the-week-52-special-attributes