当你在反编译器中查看伪代码时，可能注意到变量声明和提示旁边会有一些带有“神秘内容”的注释。

![](assets/2021/11/annot1.png)

这些注释是什么意思呢？有些含义显而易见，有些则不太直观，还有一些只在特殊情况下才会出现。

### Variable location（变量位置）

注释的第一部分是变量的位置：

- 对于 `stack variables`（栈变量），会显示相对于栈指针和帧指针的位置。
- 对于 `register variables`（寄存器变量），会显示存储其值的寄存器。

在某些情况下，你还可能看到 [scattered argloc](https://hex-rays.com/blog/igors-tip-of-the-week-51-custom-calling-conventions/) 语法。

示例：

```
struct12 v78; // 0:r2.8,8:^0.4
```

这表示一个 12 字节的结构体，其中前 8 个字节存放在寄存器 r2 中，后 4 个字节存放在栈偏移量 8 的位置。

### Variable attributes（变量属性）

在位置之后，可能会出现一些大写关键字，表示额外属性：

- `BYREF`：该变量的地址在当前函数中被取用（例如作为参数传递给函数调用）。
- `OVERLAPPED`：反编译器未能完全区分所有变量，导致某些变量存储在重叠的位置。通常此类函数还会带有注释：
  ```
  // local variable allocation has failed, the output may be wrong!
  ```
- `MAPDST`：另一个变量被映射到该变量。
- `FORCED`：这是一个被显式强制的变量。
- `ISARG`：用于函数参数（在鼠标悬停提示中显示）。

### User comment（用户注释）

局部变量还可以有用户自定义的注释，可以通过 `/` 快捷键或右键菜单添加。

![](assets/2021/11/lvar_cmt.png)

如果存在，它会显示在变量注释的最后，位于系统生成的 annotation 之后。

## Type annotations（类型注释）

除了局部变量，反编译器还会在提示中显示以下对象的注释：

- 结构体和联合体字段：显示偏移量和类型。

  ![](assets/2021/11/annot_field.png)

- 全局变量：显示类型。
- 函数和函数调用：显示参数列表及其位置。

  ![](assets/2021/11/annot_func.png)

原文地址：https://hex-rays.com/blog/igors-tip-of-the-week-66-decompiler-annotations
